# User Stories: User Management Screen

## Module: User Management
**Reference:** Figma_All_Screens.md - Section 3 (User Management Screen)  
**Related FR:** FR#MAP-1 to FR#MAP-6

---

## US-003.1: View User List
**As a** Master Admin or Practice Admin  
**I want to** view a list of all users in the system  
**So that** I can see who has access and their roles

### Acceptance Criteria:
- [ ] Display users in a tabular format with columns: Name, Email, Role, Practice, Status, Actions
- [ ] Master Admin sees all users across all practices
- [ ] Practice Admin sees users only from their assigned practice
- [ ] Display user count at the top of the list
- [ ] Show active and inactive users with visual indicators
- [ ] Default sorting by name (ascending)
- [ ] Empty state message displayed when no users exist

### UI Elements:
- User table with sortable columns
- User count badge
- Status indicator (active/inactive)
- Action menu for each user row
- Empty state illustration and message

### Business Rules:
- Master Admin: View all users
- Practice Admin: View users in assigned practice only
- Pagination: 20 users per page (default)

---

## US-003.2: Search and Filter Users
**As a** Master Admin or Practice Admin  
**I want to** search and filter users  
**So that** I can quickly find specific users

### Acceptance Criteria:
- [ ] Search box allows searching by name, email, or username
- [ ] Search results update as user types (debounced)
- [ ] Filter by role (dropdown: All, Master Admin, Practice Admin, TA Team Admin, Tech Panel Member)
- [ ] Filter by practice (dropdown: All, specific practice) - for Master Admin
- [ ] Filter by status (dropdown: All, Active, Inactive)
- [ ] Multiple filters can be applied simultaneously
- [ ] "Clear Filters" button resets all filters
- [ ] Display count of filtered results

### UI Elements:
- Search input field with search icon
- Role filter dropdown
- Practice filter dropdown (Master Admin only)
- Status filter dropdown
- Clear Filters button
- Results count label

### Related FR: FR#MAP-6 – Search Members with Filters

---

## US-003.3: Add New User
**As a** Master Admin or Practice Admin  
**I want to** add a new user to the system  
**So that** they can access the platform based on their role

### Acceptance Criteria:
- [ ] "Add User" button displayed prominently at the top
- [ ] Clicking button opens "Add User" modal/form
- [ ] Form displays all required fields with validation
- [ ] Username field validates Active Directory format (min 5, max 100 characters)
- [ ] First Name and Last Name fields (min 2, max 50 characters each)
- [ ] Email field validates aspiresys.com domain and uniqueness
- [ ] Phone number field with country code (optional)
- [ ] Role dropdown populated with allowed roles based on user's permissions
- [ ] Practice dropdown populated with active practices
- [ ] Practice field is mandatory for non-Master Admin roles
- [ ] Master Admin can select any practice; Practice Admin can only assign to their practice
- [ ] Source dropdown (Web, Mobile, API, Admin)
- [ ] Password is auto-generated by system
- [ ] "Save" button creates user and displays success message
- [ ] "Cancel" button closes form without saving
- [ ] Display validation errors inline for each field
- [ ] Success notification shows created user's MemberID

### UI Elements:
- "Add User" button (primary action)
- Modal/slide-over form with fields:
  - UserName (text input, required)
  - FirstName (text input, required)
  - LastName (text input, required)
  - EmailID (email input, required)
  - CountryCode (dropdown, optional)
  - PhoneNumber (text input, optional)
  - RoleID (dropdown, required)
  - PracticeID (dropdown, conditionally required)
  - Source (dropdown, required)
- Save button (primary)
- Cancel button (secondary)
- Inline validation messages
- Success toast notification

### Business Rules:
- Master Admin can create: Master Admin, Practice Admin, Tech Panel Member, TA Team Admin
- Practice Admin can create: Practice Admin (same practice), Tech Panel Member, TA Team Admin (same practice)
- Username must be unique
- Email must be unique and in aspiresys.com domain
- Phone number must be unique if provided
- Password is auto-generated (min 8 chars with alphabets, numbers, special characters)
- Welcome email sent to new user with credentials

### Related FR: FR#MAP-1 – Onboard Members to the System

---

## US-003.4: View/Edit User Details
**As a** Master Admin or Practice Admin  
**I want to** view and edit detailed information about a specific user  
**So that** I can see their complete profile and update details when needed

### Acceptance Criteria:
- [ ] Clicking user name or "View" action opens user detail modal/page in view mode
- [ ] Display all user information: Username, Full Name, Email, Phone, Role, Practice, Status
- [ ] Show audit information: Created Date, Modified Date, Created By, Modified By
- [ ] Display user activity summary (e.g., interviews conducted for panel members)
- [ ] Show associated practice details
- [ ] "Edit" button enables editing mode (toggles view to edit mode)
- [ ] In edit mode:
  - Form fields become editable with pre-populated data
  - Allow editing: FirstName, LastName, EmailID, PhoneNumber, RoleID, PracticeID
  - Username displayed as read-only
  - Password cannot be edited via this form
  - All validations apply as in Add User form
  - Practice Admin can only edit users in their practice
  - Master Admin can edit any user
- [ ] "Save" button updates user and displays success message (in edit mode)
- [ ] "Cancel" button discards changes and returns to view mode
- [ ] Display confirmation dialog if role or practice is changed
- [ ] "Deactivate" button available (if user has permissions)
- [ ] "Close" button returns to user list
- [ ] Audit fields updated automatically when saved (ModifiedDate, ModifiedBy)

### UI Elements:
- User detail modal/page with view/edit toggle
- Information sections: Personal Info, Role & Practice, Audit Info, Activity Summary
- Action buttons (view mode): Edit, Deactivate, Close
- Action buttons (edit mode): Save, Cancel
- Editable form fields (in edit mode)
- Confirmation dialog for role/practice changes
- Success notification

### Business Rules:
- Email uniqueness validated on update
- Phone number uniqueness validated if changed
- Role change may affect user's permissions
- Practice change reassigns user's scope
- Cannot edit deactivated users
- Must have appropriate permissions to enable edit mode

### Related FR: FR#MAP-4 – Retrieve Selected Member Details, FR#MAP-2 – Modify Member Details

---

## US-003.5: Deactivate User
**As a** Master Admin or Practice Admin  
**I want to** deactivate a user account  
**So that** they no longer have access to the system

### Acceptance Criteria:
- [ ] "Deactivate" action available in user row action menu or detail view
- [ ] Clicking "Deactivate" displays confirmation dialog
- [ ] Confirmation dialog explains consequences (user cannot login, access revoked)
- [ ] User must confirm deactivation action
- [ ] Upon confirmation, user's IsActive status set to false
- [ ] Deactivated user shown with "Inactive" badge in user list
- [ ] Success message displayed after deactivation
- [ ] Audit trail records deactivation (ModifiedDate, ModifiedBy)
- [ ] Deactivated users cannot log in
- [ ] Practice Admin can only deactivate users in their practice

### UI Elements:
- Deactivate button/action
- Confirmation dialog with warning message
- Confirm and Cancel buttons
- Success notification
- Inactive status badge

### Business Rules:
- Cannot deactivate self (logged-in user)
- Master Admin can deactivate any user
- Practice Admin can deactivate users in their practice only
- Deactivation is soft delete (data retained, IsActive = false)
- Deactivated users still visible in user list with filter

### Related FR: FR#MAP-5 – Deactivate Member

---

## US-003.6: Reactivate User
**As a** Master Admin or Practice Admin  
**I want to** reactivate a previously deactivated user  
**So that** they can regain access to the system

### Acceptance Criteria:
- [ ] "Reactivate" action available for inactive users
- [ ] Clicking "Reactivate" displays confirmation dialog
- [ ] Upon confirmation, user's IsActive status set to true
- [ ] Reactivated user shown as active in user list
- [ ] Success message displayed after reactivation
- [ ] User receives notification email about reactivation
- [ ] Audit trail records reactivation

### UI Elements:
- Reactivate button (for inactive users)
- Confirmation dialog
- Success notification

---

## US-003.7: Sort User List
**As a** Master Admin or Practice Admin  
**I want to** sort the user list by different columns  
**So that** I can organize users in a way that makes sense for my task

### Acceptance Criteria:
- [ ] Clicking column header sorts list by that column
- [ ] First click sorts ascending, second click sorts descending
- [ ] Sort indicator (arrow up/down) displayed in active column header
- [ ] Sortable columns: Name, Email, Role, Practice, Status
- [ ] Sort persists during pagination
- [ ] Default sort: Name (ascending)

### UI Elements:
- Sortable column headers with sort icons
- Sort direction indicator

---

## US-003.8: Pagination for User List
**As a** Master Admin or Practice Admin  
**I want to** navigate through pages of users  
**So that** I can view large lists without performance issues

### Acceptance Criteria:
- [ ] Display 20 users per page by default
- [ ] Page size selector: 10, 20, 50, 100 users per page
- [ ] Page navigation controls: First, Previous, Next, Last
- [ ] Display current page number and total pages
- [ ] Display total user count
- [ ] "Go to page" input for quick navigation
- [ ] Pagination controls disabled appropriately (e.g., Previous on first page)

### UI Elements:
- Pagination controls at bottom of table
- Page size dropdown
- Page number display
- Navigation buttons
- Total count label

### Related FR: FR#MAP-3 – Retrieve All Members with Pagination

---

## US-003.9: Bulk User Actions
**As a** Master Admin  
**I want to** perform actions on multiple users simultaneously  
**So that** I can manage users efficiently

### Acceptance Criteria:
- [ ] Checkbox in each user row for selection
- [ ] "Select All" checkbox in table header
- [ ] Selected user count displayed
- [ ] Bulk action dropdown appears when users selected
- [ ] Available bulk action: Deactivate
- [ ] Confirmation dialog for bulk deactivate
- [ ] Success message shows count of affected users
- [ ] Clear selection after action completion

### UI Elements:
- Selection checkboxes
- Selected count badge
- Bulk actions dropdown
- Confirmation dialog
- Success notification

---

## Technical Notes:
- Implement server-side pagination for large user lists
- Use debouncing for search input (300ms delay)
- Validate all inputs on client and server side
- Log all user management actions for audit
- Implement optimistic UI updates for better UX
- Use role-based rendering to show/hide actions

## Related Functional Requirements:
- FR#MAP-1 – Onboard Members to the System
- FR#MAP-2 – Modify Member Details
- FR#MAP-3 – Retrieve All Members with Pagination
- FR#MAP-4 – Retrieve Selected Member Details
- FR#MAP-5 – Deactivate Member
- FR#MAP-6 – Search Members with Filters

## Priority: P0 (Critical)
## Estimated Story Points: 13
